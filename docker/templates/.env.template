# =====================
# Avatar API - Environment Configuration
# Template Version: 1.0.0
# Compatible with octopize-avatar-deploy: >=1.0.0,<2.0.0
# =====================

# --- Project/Organization ---
ENV_NAME={{ ENV_NAME }}

# --- Paths & Storage ---
SECRETS_DIR=.secrets
DB_VOLUME=avatar_postgres_data
SEAWEEDFS_VOLUME=avatar_seaweedfs_data
NGINX_TLS_ENABLED={{ NGINX_TLS_ENABLED }}
NGINX_SSL_CERTIFICATE_PATH={{ NGINX_SSL_CERTIFICATE_PATH }}
NGINX_SSL_CERTIFICATE_KEY_PATH={{ NGINX_SSL_CERTIFICATE_KEY_PATH }}
{% if not NGINX_TLS_ENABLED %}
NGINX_HTTP_PORT={{ NGINX_HTTP_PORT }}
{% endif %}

# --- Service Versions ---
AVATAR_API_VERSION={{ AVATAR_API_VERSION }}
AVATAR_PDFGENERATOR_VERSION={{ AVATAR_PDFGENERATOR_VERSION }}
AVATAR_WEB_VERSION={{ AVATAR_WEB_VERSION }}
AVATAR_SEAWEEDFS_REGISTRY=quay.io/octopize
AVATAR_SEAWEEDFS_VERSION={{ AVATAR_SEAWEEDFS_VERSION }}

AVATAR_SEAWEEDFS_LOG_VERBOSITY=0

AVATAR_AUTHENTIK_VERSION={{ AVATAR_AUTHENTIK_VERSION }}
AVATAR_AUTHENTIK_REPOSITORY=ghcr.io/goauthentik

# --- Authentik Bootstrap Configuration ---
# These credentials are used for automated installation (skip OOBE)
AUTHENTIK_BOOTSTRAP_EMAIL={{ AUTHENTIK_BOOTSTRAP_EMAIL }}
AUTHENTIK_BOOTSTRAP_PASSWORD={{ AUTHENTIK_BOOTSTRAP_PASSWORD }}
AUTHENTIK_BOOTSTRAP_TOKEN={{ AUTHENTIK_BOOTSTRAP_TOKEN }}

# --- Service URLs ---
AVATAR_DOMAIN={{ PUBLIC_URL }}
# Defines the URL where the API is served.
AVATAR_API_URL=https://{{ PUBLIC_URL }}/api
# Defines the URL where the web client is served.
AVATAR_WEB_CLIENT_URL=https://{{ PUBLIC_URL }}
# Defines the URL where the PDF generator is served.
AVATAR_PDFGENERATOR_URL=http://pdfgenerator:8000
# Public and internal storage endpoint URLs
AVATAR_STORAGE_ENDPOINT_PUBLIC_URL=https://{{ PUBLIC_URL }}/storage
AVATAR_STORAGE_ENDPOINT_INTERNAL_URL=http://s3:8333


## SSO Configuration ##
SSO_CLIENT_ID={{ BLUEPRINT_CLIENT_ID }}
SSO_CLIENT_SECRET={{ BLUEPRINT_CLIENT_SECRET }}
SSO_PROVIDER_APP_NAME=avatar-api
SSO_PROVIDER_URL=https://{{ BLUEPRINT_DOMAIN }}/sso


# Number of days after which datasets will be deleted (ISO8601 timedelta string, e.g. 30d, 2w, 12h)
SHARED_STORAGE_PATH=s3://{user_id}/{expire_days}d # for seaweedfs

# --- Logging & Debug ---
# Whether to prettify the logger output. Default is false, and will output JSON.
USE_CONSOLE_LOGGING={{ USE_CONSOLE_LOGGING }}
# Whether to enable Sentry for error tracking.
IS_SENTRY_ENABLED={{ IS_SENTRY_ENABLED }}
# Logging level. Can be one of DEBUG, INFO, WARNING, ERROR, CRITICAL.
LOG_LEVEL={{ LOG_LEVEL }}

# =============================
# SMTP Email Configuration
#
# Choose between 'smtp' and 'aws' for MAIL_PROVIDER.
# If `aws` is chosen, you will be given credentials by Octopize
# to insert into the secrets directory.
# If `smtp` is chosen, you will need to provide your own SMTP server details.
# See below for SMTP configuration.
MAIL_PROVIDER={{ MAIL_PROVIDER }}


# =============================
# To enable SMTP email sending, set the following variables:
# MAIL_PROVIDER=smtp
# SMTP_HOST={{ SMTP_HOST }}
# SMTP_PORT={{ SMTP_PORT }}
# SMTP_USE_TLS={{ SMTP_USE_TLS }}
# SMTP_START_TLS={{ SMTP_START_TLS }}
# SMTP_VERIFY={{ SMTP_VERIFY }}
# SMTP_SENDER_EMAIL={{ SMTP_SENDER_EMAIL }}
# # SMTP_USERNAME=<your-smtp-username>    # Optional, if SMTP server requires auth
# # SMTP_PASSWORD=<your-smtp-password>    # Optional, if SMTP server requires auth


# # =============================

# =============================
# Email Sending Control
#
# To enable authentication for email-based login/registration, set:
USE_EMAIL_AUTHENTICATION={{ USE_EMAIL_AUTHENTICATION }}

# =============================
# To enable Telemetry, set the following variables:
{% if TELEMETRY_S3_ENDPOINT_URL %}
TELEMETRY_S3_ENDPOINT_URL={{ TELEMETRY_S3_ENDPOINT_URL }}
TELEMETRY_S3_REGION={{ TELEMETRY_S3_REGION }}
# TELEMETRY_S3_BUCKET_NAME=<bucket-name> # Will be provided to you by Octopize
{% else %}
# Telemetry is disabled
# TELEMETRY_S3_ENDPOINT_URL=
# TELEMETRY_S3_REGION=
# TELEMETRY_S3_BUCKET_NAME=
{% endif %}
# =============================
# test change
